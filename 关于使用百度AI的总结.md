# 关于使用百度AI的总结

## 前景

>&emsp; 这次是学校小程序项目，客户想要做一个人脸融合的小程序，这样学生不需要到学校来就可以把自己P到学校的照片中，做成一个云毕业照的效果，此外客户又想做全身照的p图，当然这些均在百度AI中有服务(人脸融合，人像分割)。  
>&emsp; 人像分割是只返回照片中的具体人像(不进行任何分割)，我使用的是客户端(小程序)进行网络请求，得到分割之后的人像，在使用canvas，进行图片绘制，然后导出图片从而达到人像的全身照P图。  
>&emsp; 人脸融合则是提供模板照和目标照片，将目标照片中的人脸按照比例融合到模板照上去(融合的比例可以调整，在请求参数设置，但是默认为换脸程度，此外还能选择返回图片的质量，我也选择最好，反正用的是客户的带宽流量，也不需要我的服务器参与，带宽传输和计算，所以尽量做到最好吧)

## 对于百度api使用中的QPS和服务器带宽问题

>&emsp; 客户给出的成本费用足够，预计1W+次使用量，所以服务器以及百度API的QPS都需要升级，以应对发布当日的高并发，以及服务器高处理状态，所以我计划发布当天带宽提升到10M(50元/Tina)，QPS提升到10QPS(100元/天)，来应对，但是后面一想反正用一次都要花费一次的钱，倒不如再来一个账户，两个账户一起不就是double了嘛，那再来两个账号，基本就不要买QPS了，甚为妙哉。

## 总结

>&emsp; 遇到了很奇葩的玄学错误，就是参数传递(人脸融合)时，无论怎么传递data的值(用json decode，用小程序对象设置)都会出问题，唯独官方演示码代码的字符串拼接,冒号用反斜杠转义，才成功的。这个是需要特别记住的。此外图片的大小还有要求，也因此浪费了很多使用机会。  
